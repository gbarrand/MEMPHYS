<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>&lt;h1&gt;input.memphys&lt;/h1&gt;</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.8.20 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title"><h1>input.memphys</h1>
</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The file input.memphys contains twelve "vertices" of neutrino interactions to be treated by Geant4 (one per Geant4 event).</p>
<p>The input.memphys format is an ascii file format specific to MEMPHYS. The first input event/vertex looks : </p><pre class="fragment">$ begin
$ nuance     1
$ vertex     -166.0    -279.2    -436.6  2.28845E+06
$ track       14        300.0000    0.00000    0.00000    1.00000 -1
$ track     2112        915.4158   -0.24057    0.90826    0.34234 -1
$ info 2  949000  0.0000E+00
$ track       13        200.5344   -0.81100    0.53150   -0.24451 -2
$ track     2212       1014.8815    0.31180   -0.06222    0.94811 -2
$ track       13        200.5344   -0.81100    0.53150   -0.24451  0
$ track     2212       1014.8815    0.31180   -0.06222    0.94811  0
$ end
</pre><p> Each vertex is described between "$ begin" and "$ end" lines. Each vertex is read in </p><pre class="fragment">    MEMPHYS/source/PrimaryGeneratorAction.cpp
</pre><p> From what we saw in the code (we had no doc when we got MEMPHYS code in 2005) : </p><pre class="fragment">    $ nuance   =&gt; not used.
    $ vertex   =&gt; go straight on Geant4 : particleGun-&gt;SetParticlePosition(vtx);
first : 
    $ track    =&gt; considered as the "beam". Here 14 = vu-mu.
second :
    $ track    =&gt; considered as the "target" . Here 2112 = neutron of the water.
then :
    $ info     =&gt; not used.
</pre><p> From the list of following "$ track" (here 4), only the one ending with "0" (here two, a mu- and a proton. It looks ok) are put on the Geant4 primary vertex to be tracked in the detector. For a track, after the PID, the first number is taken as the 4-energy (then "e-kin" = 4-energy-mass). The three following numbers are the normalised momentum direction. In the code, track infos are given to Geant4 with : </p><pre class="fragment">    G4double mass = particleGun-&gt;GetParticleDefinition()-&gt;GetPDGMass(); //from the PID. 
    G4double ekin = energy - mass;

    particleGun-&gt;SetParticleEnergy(ekin);
    particleGun-&gt;SetParticlePosition(vtx);
    particleGun-&gt;SetParticleMomentumDirection(dir);
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->

</body>
</html>
